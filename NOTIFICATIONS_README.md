# üîî Notification System - Saqtau Platform

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É–ª—É—á—à–µ–Ω–∏—è UX.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Backend API
- **–ú–æ–¥–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** —Å PostgreSQL
- **REST API** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è—Ö
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∞—Ü–∏—è** (–≤—ã—Å–æ–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–Ω–∏–∑–∫–∏–π)
- **–ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å—Ä–æ–∫–∞** –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### Web Browser Notifications
- **Browser API** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **Permission management**
- **Desktop notifications**
- **Fallback** –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

### Mobile Local Notifications
- **Flutter plugin** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **Android channels** (–∑–∞–∫–∞–∑—ã, —Ç–æ–≤–∞—Ä—ã, –∞–∫—Ü–∏–∏, —Å–∏—Å—Ç–µ–º–∞)
- **iOS permissions** –∏ badge count
- **Rich notifications** —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Backend
```bash
# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
await NotificationController.notifyNewOrder('ORD-001', 'partner-123');
await NotificationController.notifyOrderStatusChange('ORD-001', 'ready');
```

### Web
```typescript
// –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
await NotificationService.requestPermission();

// –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
NotificationService.showOrderNotification('ORD-001', 'confirmed');
```

### Mobile
```dart
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
await NotificationService.initialize();

// –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
await NotificationHelper.notifyNewOrder('–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', 'ORD-001');
```

## üì± –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

| –¢–∏–ø | –ò–∫–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----|--------|----------|-----------|
| `order` | üõí | –ó–∞–∫–∞–∑—ã –∏ —Å—Ç–∞—Ç—É—Å—ã | –í—ã—Å–æ–∫–∏–π |
| `product` | üì¶ | –¢–æ–≤–∞—Ä—ã (–æ—Å—Ç–∞—Ç–∫–∏, –æ—Ç–∑—ã–≤—ã) | –°—Ä–µ–¥–Ω–∏–π |
| `system` | ‚ÑπÔ∏è | –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è | –ù–∏–∑–∫–∏–π |
| `promotion` | üéâ | –ê–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏ | –ù–∏–∑–∫–∏–π |

## üé® HCI –ü—Ä–∏–Ω—Ü–∏–ø—ã

### –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è
- **–í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã** –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã
- **–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏** –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** –ø–æ —Ç–∏–ø–∞–º

### –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- **Real-time updates** –æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
- **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** –ø–æ —Ä–æ–ª—è–º (–ø—Ä–æ–¥–∞–≤–µ—Ü/–ø–æ–∫—É–ø–∞—Ç–µ–ª—å)
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** –Ω–∞ –æ—Ç–∑—ã–≤—ã –∏ –∑–∞–∫–∞–∑—ã

## üìä API Endpoints

```
GET    /api/notifications          # –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
PUT    /api/notifications/:id/read # –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
PUT    /api/notifications/read-all # –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏
DELETE /api/notifications/:id      # –£–¥–∞–ª–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Web (src/main.tsx)
```typescript
import NotificationService from './services/notificationService';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
NotificationService.initialize();
```

### Mobile (lib/main.dart)
```dart
import 'services/notification_service.dart';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
await NotificationService.initialize();
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ (Backend)
```typescript
await NotificationController.createNotification(
  partnerId,
  'üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑',
  `–ü–æ—Å—Ç—É–ø–∏–ª –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ –æ—Ç ${customerName}`,
  'order',
  { order_id: orderId },
  'high'
);
```

### –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ (Web)
```typescript
NotificationService.showNotification(
  `üì¶ –ó–∞–∫–∞–∑ ${orderId} –≥–æ—Ç–æ–≤`,
  {
    body: '–ó–∞–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ –≤ –ø—É–Ω–∫—Ç–µ –≤—ã–¥–∞—á–∏',
    icon: '/favicon.ico',
    data: { url: `/orders/${orderId}` }
  }
);
```

### –û—Ç–∑—ã–≤ —Ç–æ–≤–∞—Ä–∞ (Mobile)
```dart
await NotificationHelper.notifyNewReview(productName, rating);
```

## üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π:
- **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ** —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- **–ö–æ–Ω–≤–µ—Ä—Å–∏—è** –ø–æ —Ç–∏–ø–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Rate limiting** –¥–ª—è API endpoints
- **Permission checks** –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üöÄ Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

- ‚úÖ **Fallback** –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ **Offline support** —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ **Performance optimized** –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **Error handling** –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

## üìû –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏:
- –ù–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- –ò–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
- –ú–∞–ª—ã—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –ù–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–∞—Ö
- –ê–∫—Ü–∏—è—Ö –∏ —Å–∫–∏–¥–∫–∞—Ö
- –°–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ
